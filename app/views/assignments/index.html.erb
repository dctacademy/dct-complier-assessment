<p id="notice"><%= notice %></p>

<div class="row">
  <div class="col-lg-6">
    <h2 class="page-heading">Assignments</h2>
  </div>
  <div class="col-lg-6">
    <% if can? :create, Assignment %>
    <%= link_to 'New Assignment', new_assignment_path, class: "btn btn-primary pull-right" %>
    <% end %>
  </div>
</div>

<div class="row">
  <table id="myTable" class="table table-striped">
    <thead>
      <tr>
        <th>Title</th>
        <th>Code</th>
        <th>Body</th>
        <th>Is_allowed</th>
        <th>Ans count</th>
        <th>Tags</th>
        <th>Actions</th>
      </tr>
    </thead>

    <tbody>
      <% @assignments.each do |assignment| %>
        <tr>
          <td><%= assignment.title %></td>
          <td><%= assignment.code %></td>
          <td><%= raw (assignment.body).truncate(75) %></td>
          <td><%= assignment.is_allowed ? "true" : "false" %></td>
          <td><%= assignment.answers.size %></td>
          <td><%= assignment.tag_list %></td>
          <td><%= link_to 'Solve', assignment, class: "btn btn-success" %>
            <% if assignment.answers.find_by_user_id(current_user.id) %>
            <span class="glyphicon glyphicon-ok" aria-hidden="true" data-toggle="tooltip" title="solved" ></span>
            <% end %>
            <% if current_user %>
              <% if can? :update, assignment %>
                <%= link_to 'Edit', edit_assignment_path(assignment) , class: "btn btn-info"%>
              <% end %>
              <% if can? :destroy, assignment %>
                <%= link_to 'Destroy', assignment, method: :delete, data: { confirm: 'Are you sure?' } , class: "btn btn-danger"%></td>
              <% end %>
          <% end %>
        </tr>
      <% end %>
    </tbody>
  </table>
</div>

<script>
  $(document).ready(function(){
    $('#myTable').DataTable();
  });
</script>
